<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>Power Consumption Visualization</title>
  <link rel="stylesheet" type="text/css" href="/css" />
  <script src="//ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="//cdnjs.cloudflare.com/ajax/libs/d3/3.4.13/d3.min.js"></script>
  <script>
  	  	
  	var ovWidth = $("#overviewBackground").css("width");
  	var ovHeight = $("#overviewBackground").css("height");
  	var c1Max = .5;
  	
  	//$.getJSON("/data/circuitMax");
  	//$.getJSON("/data/circuitMin");
  	
  	$.getJSON("/data/circuitsByMinute").done(function(data)
  	{
  		var startTimeRange = new Date(data[0].start);
  		var endTimeRange = new Date(data[data.length - 1].end);
  		var rangeInMilliseconds = endTimeRange.getTime() - startTimeRange.getTime();
  		
  		var canvas = document.getElementById("overviewBackground");
  		var context = canvas.getContext("2d");

  		$.each(data, function(i, d){
  			console.log(((new Date(d.start).getTime() - startTimeRange.getTime()) / rangeInMilliseconds) * ovWidth);
  			var x = ((new Date(d.start).getTime() - startTimeRange.getTime()) / rangeInMilliseconds) * ovWidth;
  			var y = 0;
  			var w = ((new Date(d.end).getTime() - new Date(d.end).getTime()) / rangeInMilliseconds) * ovWidth;
  			var h = 5;
  			context.fillStyle = "rgba(0,0,0," + d.c1 / c1Max + ")";
  			context.fillRect(x,y,w,h);
  		});
  	});
  	
  	/*	.attr("x", function(d){
  			console.log(((new Date(d.start).getTime() - startTimeRange.getTime()) / rangeInMilliseconds) * ovWidth);
  			return ((new Date(d.start).getTime() - startTimeRange.getTime()) / rangeInMilliseconds) * ovWidth;
  		})
  		.attr("y", 0)
  		.attr("width", function(d){
  			return ((new Date(d.end).getTime() - new Date(d.end).getTime()) / rangeInMilliseconds) * ovWidth;
  		})
  		.attr("height", 5)
  		.attr("style", function(d) {"fill: " + d3.hsl(30, 1, d.c1)});
  	});*/
  	
  </script>
</head>
<body>
<div id="overviewContainer">
<canvas id="overviewBackground"></canvas>

<svg id="overviewScrollbar">
	<g class="scroll">
		<rect class="scrollbar" x="0" y="0" width="100%" height="100%"></rect>
		<g class="left-handle" transform="translate(0,0)">
		<polygon points="0,0 0,50 10,50 10,45 5,45 5,5 10,5 10,0"></polygon>
		</g>
		<g class="right-handle" transform="translate(990, 0)">
		<polygon points="0,0 10,0 10,50 0,50 0,45 5,45 5,5 0,5"></polygon>
		</g>
	</g>
</svg>
</div>
<div id="zoomContainer">
</div>
</body>
</html>
